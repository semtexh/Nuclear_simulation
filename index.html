
<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>Fallout Simulator v2</title>
  <style>
    body { font-family: Arial, sans-serif; padding: 20px; }
    select, input { margin: 10px 0; padding: 5px; width: 100%; max-width: 400px; }
    #map { height: 400px; margin-top: 20px; }
  </style>
  <link rel="stylesheet" href="https://unpkg.com/leaflet@1.9.4/dist/leaflet.css" />
</head>
<body>
  <h2>üåç Fallout Simulator (v2)</h2>

  <label>Select Country:
    <select id="countrySel">
      <option value="">-- Select Country --</option>
    </select>
  </label>

  <label>Nuclear Plant:
    <select id="plantSel">
      <option value="">-- Select Plant --</option>
    </select>
  </label>

  <label>Scenario Type:
    <select>
      <option>Reactor Meltdown</option>
      <option>Steam Explosion</option>
    </select>
  </label>

  <label>Wind Direction (¬∞):
    <input type="number" placeholder="e.g. 90">
  </label>

  <label>Wind Speed (km/h):
    <input type="number" placeholder="e.g. 30">
  </label>

  <div id="map"></div>

  <script src="https://unpkg.com/leaflet@1.9.4/dist/leaflet.js"></script>
  <script>
    const countrySel = document.getElementById("countrySel");
    const plantSel = document.getElementById("plantSel");

    let allPlants = [];

    fetch("nuclear_plants.json")
      .then(res => res.json())
      .then(data => {
        allPlants = data.features;
        const countries = [...new Set(allPlants.map(p => p.properties.Country))].sort();
        for (let c of countries) {
          let opt = document.createElement("option");
          opt.value = c;
          opt.textContent = c;
          countrySel.appendChild(opt);
        }
      });

    countrySel.addEventListener("change", () => {
      const selectedCountry = countrySel.value;
      plantSel.innerHTML = '<option value="">-- Select Plant --</option>';
      const filtered = allPlants.filter(p => p.properties.Country === selectedCountry);
      for (let plant of filtered) {
        let opt = document.createElement("option");
        opt.value = `${plant.geometry.coordinates[1]},${plant.geometry.coordinates[0]}`;
        opt.textContent = plant.properties.Name;
        plantSel.appendChild(opt);
      }
    });

    const map = L.map('map').setView([30, 0], 2);
    L.tileLayer('https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png', {
      attribution: '&copy; OpenStreetMap contributors'
    }).addTo(map);

    plantSel.addEventListener("change", () => {
      const [lat, lng] = plantSel.value.split(',').map(Number);
      map.setView([lat, lng], 6);
      L.marker([lat, lng]).addTo(map);
    });
  </script>
</body>
</html>
